<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
  <title>com.amazon.coral.metrics.reporter</title>
</head>
<body bgcolor="white">

This package provides support for emitting a QueryLog.

<a href="#" name="querylog-format"><h3>QueryLog format</h3></a>

<div class="protocol">
  QueryLog       := Record*
  Record         := BeginRecord
                      ServiceMetrics?
                      Timers?
                      Counters?
                      Attribute*
                    EndRecord

  BeginRecord    := '<em>------------------------------------------------------------------------</em>'
                     NewLine
  EndRecord      := '<em>EOE</em>'
                     NewLine

  Attribute      := Identifier '<em>=</em>' Anything

  ServiceMetrics := '<em>ServiceMetrics=</em>' Metrics? NewLine

  Metrics        := ( Scope '<em>=</em>' List ) |
                    ( Scope '<em>=</em>' List '<em>;</em>' Metrics )
  Scope          := ServiceName ( ':</em>' ServiceMethod )?
  List           := Metric | Metric '<em>,</em>' List
  Metric         := MetricName ( ':</em>' Criticality )? '<em>#</em>' Type '<em>/</em>' Value '<em>/</em>' Sample '<em>/</em>' Units?

  Timers         := '<em>Timing=</em>' Timing? NewLine
  Timing         := TimerMetric | ( TimerMetric '<em>,</em>' Timing )
  TimerScope     := [^<em>,</em>]+
  TimerMetric    := TimerScope '<em>:</em>' NonNegative<sup style="color:red">*</sup> '<em>/</em>' Sample

  Counters       := '<em>Counters=</em>' Counting? NewLine
  Counting       := CounterMetric | ( CounterMetric '<em>,</em>' Counting )
  CounterScope   := [^<em>,</em>]+
  CounterMetric  := CounterScope '<em>=</em>' NonNegative Units?

  Units          := '<em>ms</em>' | '<em>s</em>' | '<em>%</em>'
  Type           := '<em>T</em>' | '<em>L</em>' | '<em>C</em>'
  Criticality    := '<em>Critical</em>' | '<em>NonCritical</em>'

  MetricName     := Identifier
  ServiceMethod  := Identifier
  ServiceName    := Identifier

  Value          := Double
  Sample         := NonNegative
  NonNegative    := WholeNumber | '<em>0</em>'

  Identifier     := [<em>A-Za-z</em>][<em>_A-Za-z0-9</em>]+
  Double         := WholeNumber | WholeNumber '<em>.</em>' [<em>0-9</em>]*
  WholeNumber    := [<em>1-9</em>][<em>0-9</em>]*

  Anything       := [^<em>\n</em>]*
  NewLine        := '<em>\n</em>'

<sup style="color:red">*</sup><sub>Values on the timers line have no explicit unit captured in
<sup> </sup>the grammar, however the unit <b>IS</b> interpreted by TranslateToTsd as milliseconds.</sub>

</div>

</body>
</html>


<!-- Author: Eric Crahen -->
<!-- Last modified by $Author$ on $Date$ -->
